{% extends 'base_for_graph.html' %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.0.2/dist/chart.min.js"></script>

<div class="container">
    <div class="row">
        <div class="col offset-md-11">
            <p><a href='{% url 'home' %}'class="btn btn btn-primary">Return</a></p>
        </div>
    </div>

    <div class="row">
        <div class="chartMenu">
            <p>Expenditure analysis graph</p>
        </div>
        <div class="chartCard">
            <div class="chartBox">
                <canvas id="expenditure_pie_graph" width="100" height="400"></canvas>
            </div>
            <div class="chartBox">
                <canvas id="expenditure_bar_graph" width="100" height="400"></canvas>
            </div>
        </div>
            <script>
                var ctx = document.getElementById('expenditure_pie_graph').getContext('2d');
                var expenditure_graph = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels:[{% for i in expenditures_data %} '{{i.spending_category__name}}', {% endfor %}],
                        datasets: [{
                            label: '# of expenditures',
                            data:[{% for i in  expenditures_data %} {{i.exp_amount}}, {% endfor %}],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)',
                                'rgba(153, 102, 255, 0.8)',
                                'rgba(255, 159, 64, 0.8)',
                                'rgba(240, 120, 50, 0.8)',
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(240, 120, 50, 1)',

                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        scales: {
                            x: {
                                ticks: {
                                    display: false
                                }
                            },
                            y: {
                                ticks: {
                                    display: false
                                }
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
                
                var ctx = document.getElementById('expenditure_bar_graph').getContext('2d');
                var expenditure_graph = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels:[{% for i in  expenditures_data %} '{{i.spending_category__name}}', {% endfor %}],
                        datasets: [{
                            label: 'amount of expenditures',
                            data:[{% for i in  expenditures_data %} {{i.exp_amount}}, {% endfor %}],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)',
                                'rgba(153, 102, 255, 0.8)',
                                'rgba(255, 159, 64, 0.8)',
                                'rgba(240, 120, 50, 0.8)',
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(240, 120, 50, 1)',

                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        },
                        responsive: true,
                        maintainAspectRatio: false
                    }
                });
            </script>
    </div></br>
    
    <div class="row">
        <div class="row">
            <div class="col">
                <h3>Expenditures List</h3>
            </div>

            <div class="col offset-md-10">
                <label for="filter">Filter by:</label>
                <select name="filter" id="filter">
                    <option value="category">category</option>
                    <option value="amount">amount</option>
                    <option value="owner">owner</option>
                    <option value="date">date</option>
                </select>
            </div>
        </div>

        <table class="table">
            <thead>
                <tr>
                    <th scope="col">expenditure owner</th>
                    <th scope="col">date</th>
                    <th scope="col">title</th>
                    <th scope="col">description</th>
                    <th scope="col">expenditure category</th>
                    <th scope="col">amount</th>
                </tr>
            </thead>
    
            <tbody>
                {% for i in expenditures %}
                <tr class="align-middle">
                    <td> {{ i.spending_owner }}</td>
                    <td> {{ i.date }}</td>
                    <td> {{ i.title }}</td>
                    <td> {{ i.descriptions }}</td>
                    <td> {{ i.spending_category }}</td>
                    <td> {{ i.amount }}</td>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}